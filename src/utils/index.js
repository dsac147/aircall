const dayjs = require("dayjs");
const relativeTime = require("dayjs/plugin/relativeTime");

dayjs.extend(relativeTime);

export async function fetchCalls() {
  try {
    const response = await fetch(
      `https://cerulean-marlin-wig.cyclic.app/activities`
    );
    if (!response.ok) {
      throw new Error(`${response.status} ${response.statusText}`);
    }
    const result = await response.json();
    return result.reverse();
  } catch (error) {
    return { message: `${error}` };
  }
}

export async function fetchCallDetail(id) {
  try {
    if (id === null) {
      throw new Error(`Empty Id`);
    }
    const response = await fetch(
      `https://cerulean-marlin-wig.cyclic.app/activities/${id}`
    );
    if (!response.ok) {
      throw new Error(`${response.status} ${response.statusText}`);
    }
    const result = await response.json();
    console.log(result);
    return result;
  } catch (error) {
    return { message: `${error}` };
  }
}

export const getFormattedDate = (callDate) => {
  return dayjs(callDate).fromNow();
};

export const formatDuration = (sec) => {
  sec = Number(sec);

  var h = Math.floor(sec / 3600);
  var m = Math.floor((sec % 3600) / 60);
  var s = Math.floor((sec % 3600) % 60);

  return (
    ("0" + h).slice(-2) + ":" + ("0" + m).slice(-2) + ":" + ("0" + s).slice(-2)
  );
};

export const getContactName = (direction, from, to, contacs) => {
  if (direction === "outbound") {
    return contacs[to] ?? "Unknown";
  }
  if (direction === "inbound") {
    return contacs[from] ?? "Unknown";
  }
  if (!direction) {
    return from || to || "Unknown";
  }
};

export const getCallIcon = (direction, callType, size) => {
  if (direction === "outbound") {
    return (
      <svg
        width={size ?? "30px"}
        height={size ?? "30px"}
        viewBox="0 -0.5 25 25"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        stroke="#0081c2"
      >
        <g id="SVGRepo_bgCarrier" strokeWidth="0" />

        <g
          id="SVGRepo_tracerCarrier"
          strokeLinecap="round"
          strokeLinejoin="round"
        />

        <g id="SVGRepo_iconCarrier">
          {" "}
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M6.14636 10.022C6.80636 9.32201 7.03936 9.13102 7.32136 9.04102C7.51602 8.98972 7.72024 8.98664 7.91636 9.03202C8.17436 9.10802 8.24236 9.16402 9.08836 10.007C9.83136 10.747 9.90536 10.828 9.97736 10.972C10.1137 11.2264 10.1348 11.527 10.0354 11.798C9.96236 12.004 9.85336 12.14 9.40336 12.598L9.10936 12.898C9.03004 12.9772 9.01178 13.099 9.06436 13.198C9.71769 14.3125 10.6446 15.2418 11.7574 15.898C11.8855 15.9664 12.0432 15.9442 12.1474 15.843L12.4304 15.565C12.605 15.3857 12.79 15.2168 12.9844 15.059C13.2865 14.8677 13.6659 14.8454 13.9884 15C14.1454 15.074 14.1974 15.121 14.9644 15.886C15.7554 16.674 15.7774 16.699 15.8644 16.88C16.0293 17.1784 16.0293 17.5406 15.8644 17.839C15.7794 18.007 15.7274 18.068 15.2834 18.522C15.0144 18.796 14.7624 19.049 14.7224 19.084C14.3546 19.3888 13.8825 19.5381 13.4064 19.5C12.5374 19.4208 11.6964 19.1521 10.9424 18.713C9.27229 17.8278 7.85066 16.5382 6.80736 14.962C6.57927 14.6328 6.37636 14.2868 6.20036 13.927C5.73125 13.1216 5.48933 12.204 5.50036 11.272C5.53604 10.7846 5.76943 10.333 6.14636 10.022Z"
            stroke="#0081c2"
            strokeWidth="1.5"
            strokeLinecap="round"
            strokeLinejoin="round"
          />{" "}
          <path
            d="M15.7764 4.75C15.3622 4.75 15.0264 5.08579 15.0264 5.5C15.0264 5.91421 15.3622 6.25 15.7764 6.25V4.75ZM19.4884 6.25C19.9026 6.25 20.2384 5.91421 20.2384 5.5C20.2384 5.08579 19.9026 4.75 19.4884 4.75V6.25ZM20.2384 5.5C20.2384 5.08579 19.9026 4.75 19.4884 4.75C19.0742 4.75 18.7384 5.08579 18.7384 5.5H20.2384ZM18.7384 9C18.7384 9.41421 19.0742 9.75 19.4884 9.75C19.9026 9.75 20.2384 9.41421 20.2384 9H18.7384ZM20.0187 6.03033C20.3116 5.73744 20.3116 5.26256 20.0187 4.96967C19.7258 4.67678 19.2509 4.67678 18.958 4.96967L20.0187 6.03033ZM13.708 10.2197C13.4151 10.5126 13.4151 10.9874 13.708 11.2803C14.0009 11.5732 14.4758 11.5732 14.7687 11.2803L13.708 10.2197ZM15.7764 6.25H19.4884V4.75H15.7764V6.25ZM18.7384 5.5V9H20.2384V5.5H18.7384ZM18.958 4.96967L13.708 10.2197L14.7687 11.2803L20.0187 6.03033L18.958 4.96967Z"
            fill="#0081c2"
          />{" "}
        </g>
      </svg>
    );
  }
  if (callType === "missed") {
    return (
      <svg
        width={size ?? "30px"}
        height={size ?? "30px"}
        viewBox="0 -0.5 25 25"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        stroke="#e60000"
      >
        <g id="SVGRepo_bgCarrier" strokeWidth="0" />

        <g
          id="SVGRepo_tracerCarrier"
          strokeLinecap="round"
          strokeLinejoin="round"
        />

        <g id="SVGRepo_iconCarrier">
          {" "}
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M6.24034 8.16795C6.99434 7.37295 7.26134 7.14995 7.58234 7.04695C7.80483 6.98843 8.03823 6.98499 8.26234 7.03695C8.55734 7.12295 8.63434 7.18795 9.60234 8.15095C10.4523 8.99695 10.5363 9.08895 10.6183 9.25095C10.777 9.54253 10.8025 9.88825 10.6883 10.1999C10.6043 10.4349 10.4803 10.5909 9.96534 11.1089L9.62934 11.4459C9.54094 11.5356 9.51998 11.6719 9.57734 11.7839C10.3232 13.0565 11.3812 14.1179 12.6513 14.8679C12.7978 14.9465 12.9783 14.921 13.0973 14.8049L13.4203 14.4869C13.6199 14.2821 13.8313 14.0891 14.0533 13.9089C14.4015 13.6935 14.8362 13.6727 15.2033 13.8539C15.3823 13.9379 15.4423 13.9929 16.3193 14.8669C17.2193 15.7669 17.2483 15.7959 17.3493 16.0029C17.5379 16.3458 17.536 16.7618 17.3443 17.1029C17.2443 17.2949 17.1883 17.3649 16.6803 17.8839C16.3733 18.1979 16.0803 18.4839 16.0383 18.5259C15.6188 18.8727 15.081 19.043 14.5383 19.0009C13.5455 18.9101 12.5847 18.6029 11.7233 18.1009C9.81417 17.0894 8.18899 15.6155 6.99634 13.8139C6.73558 13.4376 6.50358 13.0422 6.30234 12.6309C5.76607 11.7116 5.48892 10.6642 5.50034 9.59995C5.54066 9.04147 5.80811 8.52391 6.24034 8.16795Z"
            stroke="#e60000"
            strokeWidth="1.5"
            strokeLinecap="round"
            strokeLinejoin="round"
          />{" "}
          <path
            d="M16.0187 4.46967C15.7258 4.17678 15.2509 4.17678 14.958 4.46967C14.6651 4.76256 14.6651 5.23744 14.958 5.53033L16.0187 4.46967ZM16.958 7.53033C17.2509 7.82322 17.7258 7.82322 18.0187 7.53033C18.3116 7.23744 18.3116 6.76256 18.0187 6.46967L16.958 7.53033ZM18.0187 6.46967C17.7258 6.17678 17.2509 6.17678 16.958 6.46967C16.6651 6.76256 16.6651 7.23744 16.958 7.53033L18.0187 6.46967ZM18.958 9.53033C19.2509 9.82322 19.7258 9.82322 20.0187 9.53033C20.3116 9.23744 20.3116 8.76256 20.0187 8.46967L18.958 9.53033ZM18.0187 7.53033C18.3116 7.23744 18.3116 6.76256 18.0187 6.46967C17.7258 6.17678 17.2509 6.17678 16.958 6.46967L18.0187 7.53033ZM14.958 8.46967C14.6651 8.76256 14.6651 9.23744 14.958 9.53033C15.2509 9.82322 15.7258 9.82322 16.0187 9.53033L14.958 8.46967ZM16.958 6.46967C16.6651 6.76256 16.6651 7.23744 16.958 7.53033C17.2509 7.82322 17.7258 7.82322 18.0187 7.53033L16.958 6.46967ZM20.0187 5.53033C20.3116 5.23744 20.3116 4.76256 20.0187 4.46967C19.7258 4.17678 19.2509 4.17678 18.958 4.46967L20.0187 5.53033ZM14.958 5.53033L16.958 7.53033L18.0187 6.46967L16.0187 4.46967L14.958 5.53033ZM16.958 7.53033L18.958 9.53033L20.0187 8.46967L18.0187 6.46967L16.958 7.53033ZM16.958 6.46967L14.958 8.46967L16.0187 9.53033L18.0187 7.53033L16.958 6.46967ZM18.0187 7.53033L20.0187 5.53033L18.958 4.46967L16.958 6.46967L18.0187 7.53033Z"
            fill="#e60000"
          />{" "}
        </g>
      </svg>
    );
  }
  if (direction === "inbound") {
    return (
      <svg
        width={size ?? "30px"}
        height={size ?? "30px"}
        viewBox="0 -0.5 25 25"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <g id="SVGRepo_bgCarrier" strokeWidth="0" />

        <g
          id="SVGRepo_tracerCarrier"
          strokeLinecap="round"
          strokeLinejoin="round"
        />

        <g id="SVGRepo_iconCarrier">
          {" "}
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M6.14636 9.52201C6.80636 8.82201 7.03936 8.63102 7.32136 8.54102C7.51602 8.48972 7.72024 8.48664 7.91636 8.53202C8.17436 8.60802 8.24236 8.66402 9.08836 9.50702C9.83136 10.247 9.90536 10.328 9.97736 10.472C10.1137 10.7264 10.1348 11.027 10.0354 11.298C9.96236 11.504 9.85336 11.64 9.40336 12.098L9.10936 12.398C9.03004 12.4772 9.01178 12.599 9.06436 12.698C9.71769 13.8125 10.6446 14.7418 11.7574 15.398C11.8855 15.4664 12.0432 15.4442 12.1474 15.343L12.4304 15.065C12.605 14.8857 12.79 14.7168 12.9844 14.559C13.2865 14.3677 13.6659 14.3454 13.9884 14.5C14.1454 14.574 14.1974 14.621 14.9644 15.386C15.7554 16.174 15.7774 16.199 15.8644 16.38C16.0293 16.6784 16.0293 17.0406 15.8644 17.339C15.7794 17.507 15.7274 17.568 15.2834 18.022C15.0144 18.296 14.7624 18.549 14.7224 18.584C14.3546 18.8888 13.8825 19.0381 13.4064 19C12.5374 18.9208 11.6964 18.6521 10.9424 18.213C9.27229 17.3278 7.85066 16.0382 6.80736 14.462C6.57928 14.1328 6.37637 13.7868 6.20036 13.427C5.73125 12.6216 5.48933 11.704 5.50036 10.772C5.53604 10.2846 5.76943 9.83303 6.14636 9.52201Z"
            stroke="#3ac200"
            strokeWidth="1.5"
            strokeLinecap="round"
            strokeLinejoin="round"
          />{" "}
          <path
            d="M17.9504 11C18.3646 11 18.7004 10.6642 18.7004 10.25C18.7004 9.83579 18.3646 9.5 17.9504 9.5V11ZM14.2384 9.5C13.8242 9.5 13.4884 9.83579 13.4884 10.25C13.4884 10.6642 13.8242 11 14.2384 11V9.5ZM13.4884 10.25C13.4884 10.6642 13.8242 11 14.2384 11C14.6526 11 14.9884 10.6642 14.9884 10.25H13.4884ZM14.9884 6.75C14.9884 6.33579 14.6526 6 14.2384 6C13.8242 6 13.4884 6.33579 13.4884 6.75H14.9884ZM13.708 9.71967C13.4151 10.0126 13.4151 10.4874 13.708 10.7803C14.0009 11.0732 14.4758 11.0732 14.7687 10.7803L13.708 9.71967ZM20.0187 5.53033C20.3116 5.23744 20.3116 4.76256 20.0187 4.46967C19.7258 4.17678 19.2509 4.17678 18.958 4.46967L20.0187 5.53033ZM17.9504 9.5H14.2384V11H17.9504V9.5ZM14.9884 10.25V6.75H13.4884V10.25H14.9884ZM14.7687 10.7803L20.0187 5.53033L18.958 4.46967L13.708 9.71967L14.7687 10.7803Z"
            fill="#3ac200"
          />{" "}
        </g>
      </svg>
    );
  }
  return (
    <svg
      width={size ?? "30px"}
      height={size ?? "30px"}
      viewBox="0 -0.5 25 25"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        fillRule="evenodd"
        clipRule="evenodd"
        d="M6.24033 7.16801C6.99433 6.37301 7.26133 6.15001 7.58233 6.04701C7.80482 5.98849 8.03822 5.98505 8.26233 6.03701C8.55733 6.12301 8.63433 6.18801 9.60233 7.15101C10.4523 7.99701 10.5363 8.08901 10.6183 8.25101C10.7769 8.54259 10.8024 8.88831 10.6883 9.20001C10.6043 9.43501 10.4803 9.59101 9.96533 10.109L9.62933 10.446C9.54093 10.5357 9.51997 10.6719 9.57733 10.784C10.3232 12.0566 11.3812 13.118 12.6513 13.868C12.7978 13.9465 12.9783 13.921 13.0973 13.805L13.4203 13.487C13.6199 13.2822 13.8313 13.0892 14.0533 12.909C14.4015 12.6936 14.8362 12.6728 15.2033 12.854C15.3823 12.938 15.4423 12.993 16.3193 13.867C17.2193 14.767 17.2483 14.796 17.3493 15.003C17.5379 15.3459 17.536 15.7619 17.3443 16.103C17.2443 16.295 17.1883 16.365 16.6803 16.884C16.3733 17.198 16.0803 17.484 16.0383 17.526C15.6188 17.8727 15.081 18.043 14.5383 18.001C13.5455 17.9101 12.5847 17.6029 11.7233 17.101C9.81416 16.0895 8.18898 14.6156 6.99633 12.814C6.73552 12.4374 6.50353 12.0416 6.30233 11.63C5.76624 10.711 5.48909 9.66391 5.50033 8.60001C5.54065 8.04153 5.8081 7.52397 6.24033 7.16801Z"
        stroke="#000000"
        strokeWidth="1.5"
        strokeLinecap="round"
        strokeLinejoin="round"
      />
      <path
        d="M13.9883 7.5C13.4369 7.5 12.9883 7.0514 12.9883 6.5C12.9883 5.9486 13.4369 5.5 13.9883 5.5C14.5397 5.5 14.9883 5.9486 14.9883 6.5C14.9883 7.0514 14.5397 7.5 13.9883 7.5Z"
        fill="#000000"
      />
      <path
        fillRule="evenodd"
        clipRule="evenodd"
        d="M15.4883 6.5C15.4883 5.67157 14.8168 5 13.9883 5C13.1599 5 12.4883 5.67157 12.4883 6.5C12.4883 7.32843 13.1599 8 13.9883 8C14.8168 8 15.4883 7.32843 15.4883 6.5ZM13.4883 6.5C13.4883 6.2243 13.7126 6 13.9883 6C14.264 6 14.4883 6.2243 14.4883 6.5C14.4883 6.7757 14.264 7 13.9883 7C13.7126 7 13.4883 6.7757 13.4883 6.5Z"
        fill="#000000"
      />
      <path
        d="M17.9883 7.5C17.4369 7.5 16.9883 7.0514 16.9883 6.5C16.9883 5.9486 17.4369 5.5 17.9883 5.5C18.5397 5.5 18.9883 5.9486 18.9883 6.5C18.9883 7.0514 18.5397 7.5 17.9883 7.5Z"
        fill="#000000"
      />
      <path
        fillRule="evenodd"
        clipRule="evenodd"
        d="M19.4883 6.5C19.4883 5.67157 18.8168 5 17.9883 5C17.1599 5 16.4883 5.67157 16.4883 6.5C16.4883 7.32843 17.1599 8 17.9883 8C18.8168 8 19.4883 7.32843 19.4883 6.5ZM17.4883 6.5C17.4883 6.2243 17.7126 6 17.9883 6C18.264 6 18.4883 6.2243 18.4883 6.5C18.4883 6.7757 18.264 7 17.9883 7C17.7126 7 17.4883 6.7757 17.4883 6.5Z"
        fill="#000000"
      />
    </svg>
  );
};
